{{define "activityDetail"}}
<div class="flex mt-4 items-start">
    <div class="w-64 bg-gray-100 py-4 px-2 flex flex-col items-center">
        <img class="w-24 h-24 mb-2" src="{{.app.AppIcon}}" alt="{{.app.AppName}}">
        <h1>{{.app.AppName}}</h1>
        <span>{{if .app.AppAuthor}}{{.app.AppAuthor}}{{else}}ä½šå{{end}}</span>
        <p>
            {{.app.AppDesc}}
        </p>
        <a href="/app/{{.app.Code}}" class="text-blue-600">æŸ¥çœ‹åº”ç”¨</a>

        <!-- <hr class="my-2">
        <h1>è®¢é˜…æ­¤Appä½œè€…çš„æ¶ˆæ¯</h1>
        <div class="flex m-2 items-center">
            <input class="p-2 mr-2 w-42" type="email" name="email" placeholder="è¯·è¾“å…¥é‚®ç®±...">
            <a href="">è®¢é˜…</a>
        </div> -->
    </div>
    <div class="flex-1 ml-4">
        <h1>
            {{.activity.ActivityName}}
        </h1>
        <span class="text-gray-400">{{.activity.CreatedAt}}</span>
        <hr class="my-4">
        <div class="list">
            <ol>
                {{range .codes}}
                <li class="flex p-2">
                    {{if not .Used}}
                    ğŸ”¥
                    {{end}}
                    <div class="flex-1">
                        <span>{{.InviteCode}}</span>
                        <span class="text-gray-400 text-sm">({{.Count}})äººå·²å¤åˆ¶</span>
                    </div>

                    {{if .Copied}}
                    <a href="javascript:copy('{{.Code}}')" class="text-gray-400 mr-2">
                        å·²å¤åˆ¶
                    </a>
                    {{else}}
                    <a href="javascript:copy('{{.Code}}')" class="text-blue-600 mr-2">
                        å¤åˆ¶
                    </a>
                    {{end}}

                    {{if .Used}}
                    <span class="text-gray-400 mr-2">å·²ä½¿ç”¨</span>
                    {{else}}
                    <a href="/api/codes/{{.Code}}/used" class="mr-2">
                        ç¡®è®¤æ¿€æ´»
                    </a>

                    {{end}}

                </li>
                <hr>
                {{end}}
            </ol>
        </div>
        {{template "paging" .paging}}
    </div>

    <script>
        function copy(code) {
            fetch("/api/code-copy-logs", {
                method: "post", body: JSON.stringify({
                    "invite_code": code,
                }), headers: {
                    "content-type": "application/json"
                }
            }).then(res => res.json()).then(res => {
                let data = res.data || {}
                let message = res.message || ""
                let { data: code = "" } = data
                let r = confirm("é•¿æŒ‰å¤åˆ¶!!!\næ¿€æ´»ç : " + (code || message))
                location.href = ""
            })
        }
    </script>
</div>
{{end}}
